<mxfile host="app.diagrams.net" modified="2021-02-11T20:48:29.863Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36" etag="Duo7vwyyQ4oigsclcGPV" version="14.2.9" type="github">
  <diagram id="kgpKYQtTHZ0yAKxKKP6v" name="Page-1">
    <mxGraphModel dx="1248" dy="677" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="3nuBFxr9cyL0pnOWT2aG-1" value="TalkShopLive App" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="180" y="90" width="100" height="330" as="geometry" />
        </mxCell>
        <mxCell id="3nuBFxr9cyL0pnOWT2aG-5" value="TalkShopLive App Server" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="340" y="90" width="140" height="340" as="geometry" />
        </mxCell>
        <mxCell id="3nuBFxr9cyL0pnOWT2aG-8" value="create subscription plan" style="verticalAlign=bottom;endArrow=block;entryX=0.483;entryY=0.227;shadow=0;strokeWidth=1;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.5;exitY=0.227;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="3nuBFxr9cyL0pnOWT2aG-1" target="3nuBFxr9cyL0pnOWT2aG-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="135" y="160.0000000000001" as="sourcePoint" />
            <mxPoint x="305" y="160.0000000000001" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="3nuBFxr9cyL0pnOWT2aG-9" value="recurring charge response" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;exitX=0.5;exitY=0.467;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.506;entryY=0.455;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="ayR7XXcj4JQ6BO8CJsRj-3" target="ayR7XXcj4JQ6BO8CJsRj-2" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="745" y="230" as="sourcePoint" />
            <mxPoint x="582" y="227" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-1" value="&lt;font style=&quot;font-size: 20px&quot;&gt;Recurring Charge Flow&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="270" y="40" width="260" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-2" value="TSL CMS" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="90" width="120" height="340" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-3" value="Shopify API" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="710" y="90" width="120" height="330" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-4" value="create Shopify subscription " style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;" edge="1" parent="1" target="ayR7XXcj4JQ6BO8CJsRj-2">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="410" y="180" as="sourcePoint" />
            <mxPoint x="527.6199999999999" y="180.00000000000003" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-5" value="&lt;font style=&quot;font-size: 11px&quot;&gt;&lt;font style=&quot;font-size: 11px&quot;&gt;(will be POST instead of PUT) plan_id&lt;br&gt;&lt;/font&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="450" y="191" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-6" value="recurring charges" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;entryX=0.499;entryY=0.333;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" target="ayR7XXcj4JQ6BO8CJsRj-3">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="580" y="200" as="sourcePoint" />
            <mxPoint x="769.5" y="199.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-7" value="Shopify Admin" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="90" width="100" height="330" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-9" value="confirm_url" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;exitX=0.5;exitY=0.467;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="581.08" y="251.8" as="sourcePoint" />
            <mxPoint x="410" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-10" value="confirm_url" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="411" y="270" as="sourcePoint" />
            <mxPoint x="230" y="270" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-11" value="window.top.location.href" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="231" y="300" as="sourcePoint" />
            <mxPoint x="90" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-12" value="&lt;font style=&quot;font-size: 11px&quot;&gt;= confirm_url&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="100" y="300" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-13" value="redirect to return_url" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;exitX=0.5;exitY=0.227;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" target="3nuBFxr9cyL0pnOWT2aG-5">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="90" y="350" as="sourcePoint" />
            <mxPoint x="267.6199999999999" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-14" value="serve the page user left from" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="411" y="410" as="sourcePoint" />
            <mxPoint x="230" y="410" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-15" value="charge accepted/rejected" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;exitX=0.5;exitY=0.227;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="410" y="370" as="sourcePoint" />
            <mxPoint x="580" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-16" value="plan updated (or not)" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="580.5" y="400" as="sourcePoint" />
            <mxPoint x="410" y="400" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-17" value="&lt;font style=&quot;font-size: 11px&quot;&gt;App will load and refresh its state including user&#39;s subscription plan&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="167.5" y="430" width="125" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-18" value="1) Always redirect to products even if coming from settings&lt;br&gt;2) If no plan, use free plan&lt;br&gt;3) Ping back with charge id" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="510" width="345" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-19" value="1) Empty assume free&lt;br&gt;2) Always choose active or billing_failure or suspended (if billing_failure or suspended - redirect to shop ineligible page)&lt;br&gt;3) If no active or billing_failure or suspended treat as no plan&lt;br&gt;4) If no pending, treat as no plan" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="600" width="660" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-21" value="&lt;div class=&quot;p-rich_text_section&quot; style=&quot;box-sizing: inherit ; color: rgb(209 , 210 , 211) ; font-family: , &amp;#34;applelogo&amp;#34; , sans-serif ; font-size: 15px ; background-color: rgb(26 , 29 , 33)&quot;&gt;perfect, exactly what we had in mind. Will have some updates for you during standup and we can sync directly, too. One major change we are going to need to make is that a store may now have multiple subscriptions (whereas before the guidance was only one). It will be up to client-side to determine the “active” plan. Here are the statuses a subscription can have:&lt;br style=&quot;box-sizing: inherit&quot;&gt;&lt;/div&gt;&lt;ul class=&quot;p-rich_text_list p-rich_text_list__bullet&quot; style=&quot;box-sizing: inherit ; margin: 0px ; padding: 0px ; list-style-type: none ; color: rgb(209 , 210 , 211) ; font-family: , &amp;#34;applelogo&amp;#34; , sans-serif ; font-size: 15px ; background-color: rgb(26 , 29 , 33)&quot;&gt;&lt;li style=&quot;box-sizing: inherit ; margin-bottom: 0px ; list-style-type: none ; margin-left: 28px&quot;&gt;&lt;code class=&quot;c-mrkdwn__code&quot; style=&quot;box-sizing: inherit ; padding: 2px 3px 1px ; border: 1px solid ; border-radius: 3px ; background-color: rgba(, 0.04) ; color: rgb(232 , 145 , 45) ; font-size: 12px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace &amp;#34;important&amp;#34;&quot;&gt;active&lt;/code&gt;&amp;nbsp;- there will only ever be one active subscription, but there could also be 0 if they have not confirmed the “free” tier&lt;/li&gt;&lt;li style=&quot;box-sizing: inherit ; margin-bottom: 0px ; list-style-type: none ; margin-left: 28px&quot;&gt;&lt;code class=&quot;c-mrkdwn__code&quot; style=&quot;box-sizing: inherit ; padding: 2px 3px 1px ; border: 1px solid ; border-radius: 3px ; background-color: rgba(, 0.04) ; color: rgb(232 , 145 , 45) ; font-size: 12px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace &amp;#34;important&amp;#34;&quot;&gt;pending&lt;/code&gt;&amp;nbsp;- the charge has not been accepted, this subscription will include a&amp;nbsp;&lt;code class=&quot;c-mrkdwn__code&quot; style=&quot;box-sizing: inherit ; padding: 2px 3px 1px ; border: 1px solid ; border-radius: 3px ; background-color: rgba(, 0.04) ; color: rgb(232 , 145 , 45) ; font-size: 12px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace &amp;#34;important&amp;#34;&quot;&gt;confirmation_url&lt;/code&gt;&lt;/li&gt;&lt;li style=&quot;box-sizing: inherit ; margin-bottom: 0px ; list-style-type: none ; margin-left: 28px&quot;&gt;&lt;code class=&quot;c-mrkdwn__code&quot; style=&quot;box-sizing: inherit ; padding: 2px 3px 1px ; border: 1px solid ; border-radius: 3px ; background-color: rgba(, 0.04) ; color: rgb(232 , 145 , 45) ; font-size: 12px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace &amp;#34;important&amp;#34;&quot;&gt;declined&lt;/code&gt;&amp;nbsp;- the charge was declined&lt;/li&gt;&lt;li style=&quot;box-sizing: inherit ; margin-bottom: 0px ; list-style-type: none ; margin-left: 28px&quot;&gt;&lt;code class=&quot;c-mrkdwn__code&quot; style=&quot;box-sizing: inherit ; padding: 2px 3px 1px ; border: 1px solid ; border-radius: 3px ; background-color: rgba(, 0.04) ; color: rgb(232 , 145 , 45) ; font-size: 12px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace &amp;#34;important&amp;#34;&quot;&gt;deactivated&lt;/code&gt;&amp;nbsp;- the subscription was succeeded by an “active” charge&lt;/li&gt;&lt;li style=&quot;box-sizing: inherit ; margin-bottom: 0px ; list-style-type: none ; margin-left: 28px&quot;&gt;&lt;code class=&quot;c-mrkdwn__code&quot; style=&quot;box-sizing: inherit ; padding: 2px 3px 1px ; border: 1px solid ; border-radius: 3px ; background-color: rgba(, 0.04) ; color: rgb(232 , 145 , 45) ; font-size: 12px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace &amp;#34;important&amp;#34;&quot;&gt;billing_failure&lt;/code&gt;&amp;nbsp;- The charge has become “frozen” due to non-payment&lt;/li&gt;&lt;li style=&quot;box-sizing: inherit ; margin-bottom: 0px ; list-style-type: none ; margin-left: 28px&quot;&gt;&lt;code class=&quot;c-mrkdwn__code&quot; style=&quot;box-sizing: inherit ; padding: 2px 3px 1px ; border: 1px solid ; border-radius: 3px ; background-color: rgba(, 0.04) ; color: rgb(232 , 145 , 45) ; font-size: 12px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace &amp;#34;important&amp;#34;&quot;&gt;suspended&lt;/code&gt;&amp;nbsp;- TalkShopLive has suspended the store due to terms of service violation&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;p-rich_text_section&quot; style=&quot;box-sizing: inherit ; color: rgb(209 , 210 , 211) ; font-family: , &amp;#34;applelogo&amp;#34; , sans-serif ; font-size: 15px ; background-color: rgb(26 , 29 , 33)&quot;&gt;&lt;span class=&quot;c-mrkdwn__br&quot; style=&quot;box-sizing: inherit ; display: block ; height: 8px&quot;&gt;&lt;/span&gt;There will be one new “check” to add to the “splash page/shop ineligible” workflow, and that is to ensure that a shop does not have a billing_failure or suspended subscription.&lt;span class=&quot;c-mrkdwn__br&quot; style=&quot;box-sizing: inherit ; display: block ; height: 8px&quot;&gt;&lt;/span&gt;Further more, the app will need to ensure that a shop can go no further than the on-boarding page if they do not have an “active” subscription.&lt;span class=&quot;c-message__edited_label&quot; dir=&quot;ltr&quot; style=&quot;box-sizing: inherit ; cursor: default ; font-size: 13px ; color: rgba(, 1)&quot;&gt;&amp;nbsp;(edited)&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="950" width="310" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ayR7XXcj4JQ6BO8CJsRj-23" value="&lt;div class=&quot;p-rich_text_section&quot; style=&quot;box-sizing: inherit ; font-size: 15px&quot;&gt;just for heads up for the flow circled in the screenshot, our planned route for you to ping is this:&lt;br style=&quot;box-sizing: inherit&quot;&gt;&lt;/div&gt;&lt;pre class=&quot;c-mrkdwn__pre&quot; style=&quot;box-sizing: inherit ; margin-top: 4px ; margin-bottom: 4px ; padding: 8px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; border: 1px solid ; border-radius: 4px ; background: rgba(, 0.04) ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace &amp;#34;important&amp;#34;&quot;&gt;POST &#39;api/shopify/subscriptions/check&lt;font color=&quot;#d1d2d3&quot;&gt;&lt;span style=&quot;box-sizing: inherit&quot;&gt;&lt;br style=&quot;box-sizing: inherit&quot;&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre class=&quot;c-mrkdwn__pre&quot; style=&quot;box-sizing: inherit ; margin-top: 4px ; margin-bottom: 4px ; padding: 8px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; border: 1px solid ; border-radius: 4px&quot;&gt;&lt;span style=&quot;font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace&quot;&gt;{ charge_id }&lt;/span&gt;&lt;/pre&gt;&lt;pre class=&quot;c-mrkdwn__pre&quot; style=&quot;box-sizing: inherit ; margin-top: 4px ; margin-bottom: 4px ; padding: 8px ; line-height: 1.50001 ; overflow-wrap: break-word ; word-break: normal ; border: 1px solid ; border-radius: 4px&quot;&gt;We will of course have documentation when we release this&lt;/pre&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=none;" vertex="1" parent="1">
          <mxGeometry x="420" y="760" width="370" height="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
